
# 🧠 Excel-SQL Workflow with CAMEL EmbodiedAgent

This project demonstrates how to use the enhanced `EmbodiedAgent` from the [CAMEL-AI](https://github.com/camel-ai/camel) framework to automate a complete Excel → SQL → Excel workflow, powered by language agents and integrated interpreters.

## 📌 Overview

The system performs the following workflow:

1. **Extracts field names** from an Excel file using Python code generated by an LLM.
2. **Generates SQL queries** based on the extracted fields and a database schema.
3. **Executes SQL queries** using a configured SQLite or PostgreSQL database.
4. **Writes the SQL results** back to Excel using Python.

All steps are handled by CAMEL's `EmbodiedAgent`, each equipped with either a Python or SQL interpreter, enabling structured, multi-agent, language-driven automation.

---

## 🚀 Features

- ✨ Natural-language-driven SQL generation and execution.
- 📊 Excel data extraction and output handling with Python code.
- 🧩 Modular interpreter system supporting both `python` and `sql` code types.
- 💬 End-to-end task orchestration via `EmbodiedAgent.step()`.
- 🧪 Optional CLI with an `--example` mode for testing.

---

## 🧱 Dependencies

- Python 3.8+
- [CAMEL-AI](https://github.com/camel-ai/camel) (core agent and interpreter framework)
- `openpyxl` — Excel file operations
- `sqlite3` — SQLite support (built-in)
- `psycopg2-binary` — PostgreSQL support
- `python-dotenv` — API key and environment management
- `pandas` — Optional Excel handling helper
- OpenAI API key (set as `OPENAI_API_KEY` in your environment)

Install required dependencies:

```bash
pip install openpyxl pandas python-dotenv psycopg2-binary
````

---

## 🧠 Agent Architecture

| Agent    | Interpreter        | Task                             |
| -------- | ------------------ | -------------------------------- |
| `agent1` | Python interpreter | Extract or write Excel fields    |
| `agent2` | SQL interpreter    | Generate and execute SQL queries |




---

## ⚙️ Usage

### ▶️ Run in Example Mode

This runs the full Excel-SQL-Excel loop with a prebuilt SQLite database and a sample Excel template:

```bash
python sql_to_excel.py --example
```

### 🧪 Run with Custom Inputs

```bash
python your_script.py \
  --template_path ./path/to/input_template.xlsx \
  --output_path ./path/to/output.xlsx \
  --database_schema "TABLE employees (id INTEGER, name TEXT, ...)"
```

---

## 💡 Environment Setup

Create a `.env` file in the root directory:

```
OPENAI_API_KEY=your-openai-api-key
```

---

## ✅ Example Output

```text
> Extracted fields: name, age, salary
> Generated SQL:
SELECT name, age, salary FROM employees;
> Executed Results:
name	age	salary
Alice	30	70000.0
Bob	    40	85000.0
...
> Data successfully written to ./output.xlsx
```

---

## 📌 Notes

* The SQL interpreter is configured via a `database` dictionary passed into `EmbodiedAgent`, supporting both SQLite and PostgreSQL.
* The Excel interpreter only accepts Python code and disables pip installation for safety.

---

