<a id="camel.datagen.self_instruct.self_instruct"></a>

# camel.datagen.self\_instruct.self\_instruct

<a id="camel.datagen.self_instruct.self_instruct.SelfInstructPipeline"></a>

## SelfInstructPipeline Objects

```python
class SelfInstructPipeline()
```

A pipeline to generate and manage machine-generated instructions for
tasks, combining human and machine task samples.

**Arguments**:

- `agent` _ChatAgent_ - The agent used to interact and generate
  instructions.
- `seed` _str_ - The path to the human-written instructions.
- `num_machine_instructions` _int_ - Number of machine-generated
  instructions to generate. (default::obj:`5`)
- `data_output_path` _Optional[str]_ - Path to save the generated data.
  (default::obj:`./data_output.json`)
- `human_to_machine_ratio` _tuple_ - Ratio of human to machine tasks used
  for instruction generation. (default::obj:`(6, 2)`)
- `instruction_filter` _InstructionFilter_ - A filter to validate
  generated instructions. (default::obj:`None`)
- `filter_config` _Optional[Dict[str, Dict[str, Any]]]_ - configuration
  for the filter functions registered in FILE_REGISTRY.
  (default::obj:`None`)
- `stop_on_first_failure` _bool_ - If True, stops checking filters after
  the first failure.

<a id="camel.datagen.self_instruct.self_instruct.SelfInstructPipeline.load_seed"></a>

#### load\_seed

```python
def load_seed(path: str)
```

Load seed tasks from a file. Defaults to a predefined seed file if
no path is provided.

**Arguments**:

- `path` _str_ - Path to the seed file.
  

**Raises**:

- `FileNotFoundError` - If the seed file does not exist.

<a id="camel.datagen.self_instruct.self_instruct.SelfInstructPipeline.sample_human_tasks"></a>

#### sample\_human\_tasks

```python
def sample_human_tasks(count: int) -> List[dict]
```

Sample a specified number of human tasks from the loaded seed.

**Arguments**:

- `count` _int_ - Number of human tasks to sample.
  

**Returns**:

- `List[dict]` - A list of sampled human tasks.

<a id="camel.datagen.self_instruct.self_instruct.SelfInstructPipeline.sample_machine_tasks"></a>

#### sample\_machine\_tasks

```python
def sample_machine_tasks(count: int) -> List[dict]
```

Sample a specified number of machine tasks.

**Arguments**:

- `count` _int_ - Number of machine tasks to sample.
  

**Returns**:

- `List[dict]` - A list of sampled machine tasks, with placeholders if
  insufficient tasks are available.

<a id="camel.datagen.self_instruct.self_instruct.SelfInstructPipeline.generate_machine_instruction"></a>

#### generate\_machine\_instruction

```python
def generate_machine_instruction() -> List
```

Generate a machine instruction using the agent.

Combines human and machine tasks based on the configured ratio to
create a prompt for instruction generation.

**Returns**:

- `List` - The prompt and a machine-generated instruction.

<a id="camel.datagen.self_instruct.self_instruct.SelfInstructPipeline.identify_instruction"></a>

#### identify\_instruction

```python
def identify_instruction(instruction: str) -> bool
```

Determine if the given instruction is a classification task.

**Arguments**:

- `instruction` _str_ - The instruction to classify.
  

**Returns**:

- `bool` - True if the instruction is a classification task,
  otherwise False.

<a id="camel.datagen.self_instruct.self_instruct.SelfInstructPipeline.generate_machine_instances"></a>

#### generate\_machine\_instances

```python
def generate_machine_instances()
```

Generate instances for each machine task based on its
classification status.

<a id="camel.datagen.self_instruct.self_instruct.SelfInstructPipeline.generate_machine_instance"></a>

#### generate\_machine\_instance

```python
def generate_machine_instance(instruction: str,
                              classification: bool) -> list[dict]
```

Generate instances for a given instruction.

**Arguments**:

- `instruction` _str_ - The instruction to create instances for.
- `classification` _bool_ - Whether the instruction is a classification
  task.
  

**Returns**:

- `List[dict]` - A list of generated instances in input-output format.

<a id="camel.datagen.self_instruct.self_instruct.SelfInstructPipeline.parse_classification_output"></a>

#### parse\_classification\_output

```python
def parse_classification_output(generated_text: str) -> List[Dict[str, str]]
```

Parse the generated text for classification tasks into input-output
pairs.

**Arguments**:

- `generated_text` _str_ - The raw text generated by the agent for
  classification tasks.
  

**Returns**:

  List[Dict[str, str]]: A list of dictionaries with 'input' and
  'output' keys.

<a id="camel.datagen.self_instruct.self_instruct.SelfInstructPipeline.parse_non_classification_output"></a>

#### parse\_non\_classification\_output

```python
def parse_non_classification_output(
        generated_text: str) -> List[Dict[str, str]]
```

Parse the generated text for non-classification tasks into
input-output pairs.

**Arguments**:

- `generated_text` _str_ - The raw text generated by the agent for
  non-classification tasks.
  

**Returns**:

  List[Dict[str, str]]: A list of dictionaries with 'input' and
  'output' keys.

<a id="camel.datagen.self_instruct.self_instruct.SelfInstructPipeline.construct_data"></a>

#### construct\_data

```python
def construct_data()
```

Save the machine-generated tasks to the specified output path
in JSON format.

<a id="camel.datagen.self_instruct.self_instruct.SelfInstructPipeline.generate"></a>

#### generate

```python
def generate(timeout_minutes=600)
```

Execute the entire pipeline to generate machine instructions
and instances.

**Arguments**:

- `timeout_minutes` _int_ - Maximum time in minutes to run the
  generation process before timing out. (default: :obj:`600`)

