<a id="camel.storages.graph_storages.neo4j_graph"></a>

# camel.storages.graph\_storages.neo4j\_graph

<a id="camel.storages.graph_storages.neo4j_graph.Neo4jGraph"></a>

## Neo4jGraph Objects

```python
class Neo4jGraph(BaseGraphStorage)
```

Provides a connection to a Neo4j database for various graph operations.

The detailed information about Neo4j is available at:
`Neo4j https://neo4j.com/docs/getting-started`

This module referred to the work of Langchian and Llamaindex.

**Arguments**:

- `url` _str_ - The URL of the Neo4j database server.
- `username` _str_ - The username for database authentication.
- `password` _str_ - The password for database authentication.
- `database` _str_ - The name of the database to connect to. Defaults to
  `neo4j`.
- `timeout` _Optional[float]_ - The timeout for transactions in seconds.
  Useful for terminating long-running queries. Defaults to `None`.
- `truncate` _bool_ - A flag to indicate whether to remove lists with more
  than `LIST_LIMIT` elements from results. Defaults to `False`.

<a id="camel.storages.graph_storages.neo4j_graph.Neo4jGraph.__init__"></a>

#### \_\_init\_\_

```python
@dependencies_required('neo4j')
def __init__(url: str,
             username: str,
             password: str,
             database: str = "neo4j",
             timeout: Optional[float] = None,
             truncate: bool = False) -> None
```

Create a new Neo4j graph instance.

<a id="camel.storages.graph_storages.neo4j_graph.Neo4jGraph.get_client"></a>

#### get\_client

```python
@property
def get_client() -> Any
```

Get the underlying graph storage client.

<a id="camel.storages.graph_storages.neo4j_graph.Neo4jGraph.get_schema"></a>

#### get\_schema

```python
@property
def get_schema(refresh: bool = False) -> str
```

Retrieve the schema of the Neo4jGraph store.

**Arguments**:

- `refresh` _bool_ - A flag indicating whether to forcibly refresh the
  schema from the Neo4jGraph store regardless of whether it is
  already cached. Defaults to `False`.
  

**Returns**:

- `str` - The schema of the Neo4jGraph store.

<a id="camel.storages.graph_storages.neo4j_graph.Neo4jGraph.get_structured_schema"></a>

#### get\_structured\_schema

```python
@property
def get_structured_schema() -> Dict[str, Any]
```

Returns the structured schema of the graph

**Returns**:

  Dict[str, Any]: The structured schema of the graph.

<a id="camel.storages.graph_storages.neo4j_graph.Neo4jGraph.query"></a>

#### query

```python
def query(query: str,
          params: Optional[Dict[str, Any]] = None) -> List[Dict[str, Any]]
```

Executes a Neo4j Cypher declarative query in a database.

**Arguments**:

- `query` _str_ - The Cypher query to be executed.
- `params` _Optional[Dict[str, Any]]_ - A dictionary of parameters to
  be used in the query. Defaults to `None`.
  

**Returns**:

  List[Dict[str, Any]]: A list of dictionaries, each
  dictionary represents a row of results from the Cypher query.
  

**Raises**:

- `ValueError` - If the executed Cypher query syntax is invalid.

<a id="camel.storages.graph_storages.neo4j_graph.Neo4jGraph.refresh_schema"></a>

#### refresh\_schema

```python
def refresh_schema() -> None
```

Refreshes the Neo4j graph schema information by querying the
database for node properties, relationship properties, and
relationships.

<a id="camel.storages.graph_storages.neo4j_graph.Neo4jGraph.add_triplet"></a>

#### add\_triplet

```python
def add_triplet(subj: str,
                obj: str,
                rel: str,
                timestamp: Optional[str] = None) -> None
```

Adds a relationship (triplet) between two entities
in the database with a timestamp.

**Arguments**:

- `subj` _str_ - The identifier for the subject entity.
- `obj` _str_ - The identifier for the object entity.
- `rel` _str_ - The relationship between the subject and object.
- `timestamp` _Optional[str]_ - The timestamp of the relationship.
  Defaults to None.

<a id="camel.storages.graph_storages.neo4j_graph.Neo4jGraph.delete_triplet"></a>

#### delete\_triplet

```python
def delete_triplet(subj: str, obj: str, rel: str) -> None
```

Deletes a specific triplet from the graph, comprising a subject,
object and relationship.

**Arguments**:

- `subj` _str_ - The identifier for the subject entity.
- `obj` _str_ - The identifier for the object entity.
- `rel` _str_ - The relationship between the subject and object.

<a id="camel.storages.graph_storages.neo4j_graph.Neo4jGraph.add_graph_elements"></a>

#### add\_graph\_elements

```python
def add_graph_elements(graph_elements: List[GraphElement],
                       include_source: bool = False,
                       base_entity_label: bool = False) -> None
```

Adds nodes and relationships from a list of GraphElement objects
to the graph storage.

**Arguments**:

- `graph_elements` _List[GraphElement]_ - A list of GraphElement
  objects that contain the nodes and relationships to be added
  to the graph. Each GraphElement should encapsulate the
  structure of part of the graph, including nodes,
  relationships, and the source element information.
- `include_source` _bool, optional_ - If True, stores the source
  element and links it to nodes in the graph using the MENTIONS
  relationship. This is useful for tracing back the origin of
  data. Merges source elements based on the `id` property from
  the source element metadata if available; otherwise it
  calculates the MD5 hash of `page_content` for merging process.
  Defaults to `False`.
- `base_entity_label` _bool, optional_ - If True, each newly created
  node gets a secondary `BASE_ENTITY_LABEL` label, which is
  indexed and improves import speed and performance. Defaults to
  `False`.

<a id="camel.storages.graph_storages.neo4j_graph.Neo4jGraph.random_walk_with_restarts"></a>

#### random\_walk\_with\_restarts

```python
def random_walk_with_restarts(
        graph_name: str,
        sampling_ratio: float,
        start_node_ids: List[int],
        restart_probability: float = 0.1,
        node_label_stratification: bool = False,
        relationship_weight_property: Optional[str] = None) -> Dict[str, Any]
```

Runs the Random Walk with Restarts (RWR) sampling algorithm.

**Arguments**:

- `graph_name` _str_ - The name of the original graph in the graph
  catalog.
- `sampling_ratio` _float_ - The fraction of nodes in the original
  graph to be sampled.
- `start_node_ids` _List[int]_ - IDs of the initial set of nodes of the
  original graph from which the sampling random walks will start.
- `restart_probability` _float, optional_ - The probability that a
  sampling random walk restarts from one of the start nodes.
  Defaults to `0.1`.
- `node_label_stratification` _bool, optional_ - If true, preserves the
  node label distribution of the original graph. Defaults to
  `False`.
- `relationship_weight_property` _Optional[str], optional_ - Name of
  the relationship property to use as weights. If unspecified,
  the algorithm runs unweighted. Defaults to `None`.
  

**Returns**:

  Dict[str, Any]: A dictionary with the results of the RWR sampling.

<a id="camel.storages.graph_storages.neo4j_graph.Neo4jGraph.common_neighbour_aware_random_walk"></a>

#### common\_neighbour\_aware\_random\_walk

```python
def common_neighbour_aware_random_walk(
        graph_name: str,
        sampling_ratio: float,
        start_node_ids: List[int],
        node_label_stratification: bool = False,
        relationship_weight_property: Optional[str] = None) -> Dict[str, Any]
```

Runs the Common Neighbour Aware Random Walk (CNARW) sampling
algorithm.

**Arguments**:

- `graph_name` _str_ - The name of the original graph in the graph
  catalog.
- `sampling_ratio` _float_ - The fraction of nodes in the original
  graph to be sampled.
- `start_node_ids` _List[int]_ - IDs of the initial set of nodes of the
  original graph from which the sampling random walks will start.
- `node_label_stratification` _bool, optional_ - If true, preserves the
  node label distribution of the original graph. Defaults to
  `False`.
- `relationship_weight_property` _Optional[str], optional_ - Name of
  the relationship property to use as weights. If unspecified,
  the algorithm runs unweighted. Defaults to `None`.
  

**Returns**:

  Dict[str, Any]: A dictionary with the results of the CNARW
  sampling.

<a id="camel.storages.graph_storages.neo4j_graph.Neo4jGraph.get_triplet"></a>

#### get\_triplet

```python
def get_triplet(subj: Optional[str] = None,
                obj: Optional[str] = None,
                rel: Optional[str] = None) -> List[Dict[str, Any]]
```

Query triplet information. If subj, obj, or rel is
not specified, returns all matching triplets.

**Arguments**:

- `subj` _Optional[str]_ - The ID of the subject node.
  If None, matches any subject node.
- `(default` - :obj:`None`)
- `obj` _Optional[str]_ - The ID of the object node.
  If None, matches any object node.
- `(default` - :obj:`None`)
- `rel` _Optional[str]_ - The type of relationship.
  If None, matches any relationship type.
- `(default` - :obj:`None`)
  

**Returns**:

  List[Dict[str, Any]]: A list of matching triplets,
  each containing subj, obj, rel, and timestamp.

