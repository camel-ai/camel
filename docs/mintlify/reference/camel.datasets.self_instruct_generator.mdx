<a id="camel.datasets.self_instruct_generator"></a>

<a id="camel.datasets.self_instruct_generator.SelfInstructGenerator"></a>

## SelfInstructGenerator Objects

```python
class SelfInstructGenerator(BaseGenerator)
```

A generator for creating synthetic datapoints using self-instruct.

It utilizes both a human-provided dataset (seed_dataset) and generated
machine instructions (machine_instructions) to produce new, synthetic
datapoints that include a question, a computed rationale (code), and a
final answer (from a verifier).

<a id="camel.datasets.self_instruct_generator.SelfInstructGenerator.QuestionSchema"></a>

## QuestionSchema Objects

```python
class QuestionSchema(BaseModel)
```

Schema for the generated question.

**Attributes**:

- `question` _str_ - The question generated by the model.

<a id="camel.datasets.self_instruct_generator.SelfInstructGenerator.RationaleSchema"></a>

## RationaleSchema Objects

```python
class RationaleSchema(BaseModel)
```

Schema for the generated rationale code.

**Attributes**:

- `code` _str_ - The generated code without any formatting.

<a id="camel.datasets.self_instruct_generator.SelfInstructGenerator.__init__"></a>

#### \_\_init\_\_

```python
def __init__(seed_dataset: StaticDataset,
             verifier: BaseVerifier,
             instruction_agent: Optional[ChatAgent] = None,
             rationale_agent: Optional[ChatAgent] = None,
             seed: int = 42,
             **kwargs)
```

Initialize the self-instruct generator.

**Arguments**:

- `seed_dataset` _StaticDataset_ - Dataset containing seed instructions.
- `verifier` _BaseVerifier_ - Verifier instance to validate generated
  solutions.
- `instruction_agent` _Optional[ChatAgent]_ - Agent for generating
  instructions. If not provided, a default agent will be created.
- `rationale_agent` _Optional[ChatAgent]_ - Agent for generating
  rationales. If not provided, a default agent will be created.
- `seed` _int_ - Random seed for reproducibility. (default: :obj:`42`)
- `**kwargs` - Additional keyword arguments passed to the BaseGenerator.

<a id="camel.datasets.self_instruct_generator.SelfInstructGenerator.default_instruction_agent"></a>

#### default\_instruction\_agent

```python
def default_instruction_agent() -> ChatAgent
```

Create the default instruction generation agent.

This agent is configured with a moderate temperature setting to
encourage creative and diverse instruction generation behavior.

**Returns**:

- `ChatAgent` - An agent with the default instruction prompt.

<a id="camel.datasets.self_instruct_generator.SelfInstructGenerator.default_rationale_agent"></a>

#### default\_rationale\_agent

```python
def default_rationale_agent() -> ChatAgent
```

Create the default rationale generation agent.

This agent is configured with a deterministic (zero temperature)
setting to ensure consistent and precise rationale generation based on
a given instruction and package list.

**Returns**:

- `ChatAgent` - An agent with the rationale prompt

<a id="camel.datasets.self_instruct_generator.SelfInstructGenerator.format_support_block"></a>

#### format\_support\_block

```python
@staticmethod
def format_support_block(dp: DataPoint) -> str
```

Format a DataPoint into a few-shot example block.

**Arguments**:

- `dp` _DataPoint_ - A data point.
  

**Returns**:

- `str` - A formatted string containing the question and its
  corresponding code block in Markdown-style Python format.

<a id="camel.datasets.self_instruct_generator.SelfInstructGenerator.generate_new_instruction"></a>

#### generate\_new\_instruction

```python
def generate_new_instruction(agent: ChatAgent,
                             support_human_dps: list[DataPoint],
                             support_machine_dps: list[DataPoint]) -> str
```

Generate a new instruction using self-instruct prompting.

**Arguments**:

- `agent` _ChatAgent_ - The agent to use for generating the instruction.
- `support_human_dps` _list[DataPoint]_ - List of human examples to
  sample.
- `support_machine_dps` _list[DataPoint]_ - List of machine examples to
  sample.
  

**Returns**:

- `str` - The newly generated question.

<a id="camel.datasets.self_instruct_generator.SelfInstructGenerator.generate_rationale"></a>

#### generate\_rationale

```python
def generate_rationale(
        question: str,
        agent: Optional[ChatAgent] = None,
        support_human_dps: Optional[list[DataPoint]] = None) -> str
```

Generate rationale code (solution) for the given question.

**Arguments**:

- `question` _str_ - The question to be solved.
- `agent` _Optional[ChatAgent]_ - The agent to use for generating the
  rationale. If None is provided, the default rationale agent
  will be used. (default: :obj:`None`)
- `support_human_dps` _Optional[list[DataPoint]]_ - List of human
  examples to sample. (default: :obj:`None`)
  

**Returns**:

- `str` - The generated code solution as a string.

<a id="camel.datasets.self_instruct_generator.SelfInstructGenerator.generate_new"></a>

#### generate\_new

```python
async def generate_new(n: int,
                       max_retries: int = 10,
                       human_sample_count: int = 3,
                       machine_sample_count: int = 1,
                       **kwargs) -> None
```

Generates and validates `n` new datapoints through
self-instruct prompting, with a retry limit.

**Arguments**:

- `n` _int_ - The number of valid datapoints to generate.
- `max_retries` _int_ - Maximum number of retries before stopping.
- `(default` - :obj:`10`)
- `human_sample_count` _int_ - Number of human examples to sample.
- `(default` - :obj:`3`)
- `machine_sample_count` _int_ - Number of machine examples to sample.
- `(default` - :obj:`1`)
- `**kwargs` - Additional keyword arguments.
  

**Notes**:

  - Retries on validation failures until `n` valid datapoints exist
  or `max_retries` is reached, whichever comes first.
  - If retries are exhausted before reaching `n`, a `RuntimeError`
  is raised.
  - Metadata includes a timestamp for tracking datapoint creation.

