<a id="camel.societies.workforce.single_agent_worker"></a>

<a id="camel.societies.workforce.single_agent_worker.AgentPool"></a>

## AgentPool

```python
class AgentPool:
```

A pool of agent instances for efficient reuse.

This pool manages a collection of pre-cloned agents with automatic
scaling and idle timeout cleanup.

**Parameters:**

- **base_agent** (ChatAgent): The base agent to clone from.
- **initial_size** (int): Initial number of agents in the pool. (default: :obj:`1`)
- **max_size** (int): Maximum number of agents in the pool. (default: :obj:`10`)
- **auto_scale** (bool): Whether to automatically scale the pool size. (default: :obj:`True`)
- **idle_timeout** (float): Time in seconds after which idle agents are removed. (default: :obj:`180.0`)
- **cleanup_interval** (float): Fixed interval in seconds between cleanup checks. (default: :obj:`60.0`)

<a id="camel.societies.workforce.single_agent_worker.AgentPool.__init__"></a>

### __init__

```python
def __init__(
    self,
    base_agent: ChatAgent,
    initial_size: int = 1,
    max_size: int = 10,
    auto_scale: bool = True,
    idle_timeout: float = 180.0,
    cleanup_interval: float = 60.0
):
```

<a id="camel.societies.workforce.single_agent_worker.AgentPool._initialize_pool"></a>

### _initialize_pool

```python
def _initialize_pool(self, size: int):
```

Initialize the pool with the specified number of agents.

<a id="camel.societies.workforce.single_agent_worker.AgentPool._create_fresh_agent"></a>

### _create_fresh_agent

```python
def _create_fresh_agent(self):
```

Create a fresh agent instance.

<a id="camel.societies.workforce.single_agent_worker.AgentPool.get_stats"></a>

### get_stats

```python
def get_stats(self):
```

Get pool statistics.

<a id="camel.societies.workforce.single_agent_worker.SingleAgentWorker"></a>

## SingleAgentWorker

```python
class SingleAgentWorker(Worker):
```

A worker node that consists of a single agent.

**Parameters:**

- **description** (str): Description of the node.
- **worker** (ChatAgent): Worker of the node. A single agent.
- **use_agent_pool** (bool): Whether to use agent pool for efficiency. (default: :obj:`True`)
- **pool_initial_size** (int): Initial size of the agent pool. (default: :obj:`1`)
- **pool_max_size** (int): Maximum size of the agent pool. (default: :obj:`10`)
- **auto_scale_pool** (bool): Whether to auto-scale the agent pool. (default: :obj:`True`)
- **use_structured_output_handler** (bool, optional): Whether to use the structured output handler instead of native structured output. When enabled, the workforce will use prompts with structured output instructions and regex extraction to parse responses. This ensures compatibility with agents that don't reliably support native structured output. When disabled, the workforce uses the native response_format parameter. (default: :obj:`True`)
- **context_utility** (ContextUtility, optional): Shared context utility instance for workflow management. If provided, all workflow operations will use this shared instance instead of creating a new one. This ensures multiple workers share the same session directory. (default: :obj:`None`)
- **enable_workflow_memory** (bool, optional): Whether to enable workflow memory accumulation during task execution. When enabled, conversations from all task executions are accumulated for potential workflow saving. Set to True if you plan to call save_workflow_memories(). (default: :obj:`False`)

<a id="camel.societies.workforce.single_agent_worker.SingleAgentWorker.__init__"></a>

### __init__

```python
def __init__(
    self,
    description: str,
    worker: ChatAgent,
    use_agent_pool: bool = True,
    pool_initial_size: int = 1,
    pool_max_size: int = 10,
    auto_scale_pool: bool = True,
    use_structured_output_handler: bool = True,
    context_utility: Optional[ContextUtility] = None,
    enable_workflow_memory: bool = False
):
```

<a id="camel.societies.workforce.single_agent_worker.SingleAgentWorker.reset"></a>

### reset

```python
def reset(self):
```

Resets the worker to its initial state.

<a id="camel.societies.workforce.single_agent_worker.SingleAgentWorker._get_context_utility"></a>

### _get_context_utility

```python
def _get_context_utility(self):
```

Get context utility with lazy initialization.

<a id="camel.societies.workforce.single_agent_worker.SingleAgentWorker._get_conversation_accumulator"></a>

### _get_conversation_accumulator

```python
def _get_conversation_accumulator(self):
```

Get or create the conversation accumulator agent.

<a id="camel.societies.workforce.single_agent_worker.SingleAgentWorker.get_pool_stats"></a>

### get_pool_stats

```python
def get_pool_stats(self):
```

Get agent pool statistics if pool is enabled.

<a id="camel.societies.workforce.single_agent_worker.SingleAgentWorker.save_workflow_memories"></a>

### save_workflow_memories

```python
def save_workflow_memories(self):
```

**Returns:**

  Dict[str, Any]: Result dictionary with keys:
- status (str): "success" or "error"
- summary (str): Generated workflow summary
- file_path (str): Path to saved file
- worker_description (str): Worker description used

<a id="camel.societies.workforce.single_agent_worker.SingleAgentWorker.load_workflow_memories"></a>

### load_workflow_memories

```python
def load_workflow_memories(
    self,
    pattern: Optional[str] = None,
    max_files_to_load: int = 3,
    session_id: Optional[str] = None
):
```

Load workflow memories matching worker description
from saved files.

This method searches for workflow memory files that match the worker's
description and loads them into the agent's memory using
ContextUtility.

**Parameters:**

- **pattern** (Optional[str]): Custom search pattern for workflow memory files. If None, uses worker description to generate pattern.
- **max_files_to_load** (int): Maximum number of workflow files to load. (default: :obj:`3`)
- **session_id** (Optional[str]): Specific workforce session ID to load from. If None, searches across all sessions. (default: :obj:`None`)

**Returns:**

  bool: True if workflow memories were successfully loaded, False
otherwise.

<a id="camel.societies.workforce.single_agent_worker.SingleAgentWorker._find_workflow_files"></a>

### _find_workflow_files

```python
def _find_workflow_files(self, pattern: Optional[str], session_id: Optional[str] = None):
```

Find and return sorted workflow files matching the pattern.

**Parameters:**

- **pattern** (Optional[str]): Custom search pattern for workflow files. If None, uses worker description to generate pattern.
- **session_id** (Optional[str]): Specific session ID to search in. If None, searches across all sessions.

**Returns:**

  List[str]: Sorted list of workflow file paths (empty if
validation fails).

<a id="camel.societies.workforce.single_agent_worker.SingleAgentWorker._load_workflow_files"></a>

### _load_workflow_files

```python
def _load_workflow_files(self, workflow_files: List[str], max_files_to_load: int):
```

Load workflow files and return count of successful loads.

**Parameters:**

- **workflow_files** (List[str]): List of workflow file paths to load.

**Returns:**

  int: Number of successfully loaded workflow files.

<a id="camel.societies.workforce.single_agent_worker.SingleAgentWorker._validate_workflow_save_requirements"></a>

### _validate_workflow_save_requirements

```python
def _validate_workflow_save_requirements(self):
```

**Returns:**

  Optional[Dict[str, Any]]: Error result dict if validation fails,
None if validation passes.

<a id="camel.societies.workforce.single_agent_worker.SingleAgentWorker._generate_workflow_filename"></a>

### _generate_workflow_filename

```python
def _generate_workflow_filename(self):
```

**Returns:**

  str: Sanitized filename without timestamp (session already has
timestamp).

<a id="camel.societies.workforce.single_agent_worker.SingleAgentWorker._prepare_workflow_prompt"></a>

### _prepare_workflow_prompt

```python
def _prepare_workflow_prompt(self):
```

**Returns:**

  str: Structured prompt for workflow summary.

<a id="camel.societies.workforce.single_agent_worker.SingleAgentWorker._select_agent_for_summarization"></a>

### _select_agent_for_summarization

```python
def _select_agent_for_summarization(self, context_util: ContextUtility):
```

Select the best agent for workflow summarization.

**Parameters:**

- **context_util**: Context utility to set on selected agent.

**Returns:**

  ChatAgent: Agent to use for summarization.
