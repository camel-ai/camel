<a id="camel.toolkits.microsoft_outlook_mail_toolkit"></a>

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.RedirectHandler"></a>

## RedirectHandler

```python
class RedirectHandler(BaseHTTPRequestHandler):
```

Handler for OAuth redirect requests.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.RedirectHandler.do_GET"></a>

### do_GET

```python
def do_GET(self):
```

Handles GET request and extracts authorization code.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.RedirectHandler.log_message"></a>

### log_message

```python
def log_message(self, format, *args):
```

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.CustomAzureCredential"></a>

## CustomAzureCredential

```python
class CustomAzureCredential:
```

Creates a sync Azure credential to pass into MSGraph client.

Implements Azure credential interface with automatic token refresh using
a refresh token. Updates the refresh token file whenever Microsoft issues
a new refresh token during the refresh flow.

**Parameters:**

- **client_id** (str): The OAuth client ID.
- **client_secret** (str): The OAuth client secret.
- **tenant_id** (str): The Microsoft tenant ID.
- **refresh_token** (str): The refresh token from OAuth flow.
- **scopes** (List[str]): List of OAuth permission scopes.
- **refresh_token_file_path** (Optional[Path]): File path of json file with refresh token.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.CustomAzureCredential.__init__"></a>

### __init__

```python
def __init__(
    self,
    client_id: str,
    client_secret: str,
    tenant_id: str,
    refresh_token: str,
    scopes: List[str],
    refresh_token_file_path: Optional[Path]
):
```

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.CustomAzureCredential._refresh_access_token"></a>

### _refresh_access_token

```python
def _refresh_access_token(self):
```

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.CustomAzureCredential._save_refresh_token"></a>

### _save_refresh_token

```python
def _save_refresh_token(self, refresh_token: str):
```

Saves the refresh token to file.

**Parameters:**

- **refresh_token** (str): The refresh token to save.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.CustomAzureCredential.get_token"></a>

### get_token

```python
def get_token(self, *args, **kwargs):
```

Gets a valid AccessToken object for msgraph (sync).

Called by Microsoft Graph SDK when making API requests.
Automatically refreshes the token if expired.

**Returns:**

  AccessToken: Azure AccessToken with token and expiration.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit"></a>

## OutlookMailToolkit

```python
class OutlookMailToolkit(BaseToolkit):
```

A comprehensive toolkit for Microsoft Outlook Mail operations.

This class provides methods for Outlook Mail operations including sending
emails, managing drafts, replying to mails, deleting mails, fetching
mails and attachments and changing folder of mails.
API keys can be accessed in the Azure portal (https://portal.azure.com/)

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit.__init__"></a>

### __init__

```python
def __init__(
    self,
    timeout: Optional[float] = None,
    refresh_token_file_path: Optional[str] = None
):
```

Initializes a new instance of the OutlookMailToolkit.

**Parameters:**

- **timeout** (Optional[float]): The timeout value for API requests in seconds. If None, no timeout is applied. (default: :obj:`None`)
- **refresh_token_file_path** (Optional[str]): The path of json file where refresh token is stored. If None, authentication using web browser will be required on each initialization. If provided, the refresh token is read from the file, used, and automatically updated when it nears expiry. (default: :obj:`None`)

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit._get_dynamic_redirect_uri"></a>

### _get_dynamic_redirect_uri

```python
def _get_dynamic_redirect_uri(self):
```

**Returns:**

  str: A redirect URI with format 'http://localhost:`<port>`' where
port is an available port on the system.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit._normalize_scopes"></a>

### _normalize_scopes

```python
def _normalize_scopes(self, scopes: List[str]):
```

Normalizes OAuth scopes to what Azure Identity expects.

Azure Identity credentials (used by Kiota/MSGraph) expect fully
qualified scopes like `https://graph.microsoft.com/Mail.Send`.
For backwards compatibility, this method also accepts short scopes
like `Mail.Send` and prefixes them with Microsoft Graph resource.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit._get_auth_url"></a>

### _get_auth_url

```python
def _get_auth_url(
    self,
    client_id,
    tenant_id,
    redirect_uri,
    scopes
):
```

Constructs the Microsoft authorization URL.

**Parameters:**

- **client_id** (str): The OAuth client ID.
- **tenant_id** (str): The Microsoft tenant ID.
- **redirect_uri** (str): The redirect URI for OAuth callback.
- **scopes** (List[str]): List of permission scopes.

**Returns:**

  str: The complete authorization URL.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit._load_token_from_file"></a>

### _load_token_from_file

```python
def _load_token_from_file(self):
```

**Returns:**

  Optional[str]: Refresh token if file exists and valid, else None.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit._save_token_to_file"></a>

### _save_token_to_file

```python
def _save_token_to_file(self, refresh_token: str):
```

Saves refresh token to disk.

**Parameters:**

- **refresh_token** (str): The refresh token to save.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit._authenticate_using_refresh_token"></a>

### _authenticate_using_refresh_token

```python
def _authenticate_using_refresh_token(self):
```

**Returns:**

  CustomAzureCredential: Credential with auto-refresh capability.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit._authenticate_using_browser"></a>

### _authenticate_using_browser

```python
def _authenticate_using_browser(self):
```

**Returns:**

  CustomAzureCredential or AuthorizationCodeCredential :
Credential for Microsoft Graph API.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit._get_authorization_code_via_browser"></a>

### _get_authorization_code_via_browser

```python
def _get_authorization_code_via_browser(self, auth_url: str):
```

Opens a browser and captures the authorization code via localhost.

**Parameters:**

- **auth_url** (str): The authorization URL to open in the browser.

**Returns:**

  str: The captured authorization code.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit._exchange_authorization_code_for_tokens"></a>

### _exchange_authorization_code_for_tokens

```python
def _exchange_authorization_code_for_tokens(self, authorization_code: str, scope: List[str]):
```

Exchanges an authorization code for tokens via OAuth token endpoint.

**Parameters:**

- **authorization_code** (str): Authorization code captured from browser.
- **scope** (List[str]): Scopes requested in the authorization flow.

**Returns:**

  Dict[str, Any]: Token response JSON.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit._authenticate"></a>

### _authenticate

```python
def _authenticate(self):
```

**Returns:**

  AuthorizationCodeCredential or CustomAzureCredential

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit._get_graph_client"></a>

### _get_graph_client

```python
def _get_graph_client(self, credentials, scopes):
```

Creates Microsoft Graph API client.

**Parameters:**

- **credentials**: AuthorizationCodeCredential or AsyncCustomAzureCredential.
- **scopes** (List[str]): List of permission scopes.

**Returns:**

  GraphServiceClient: Microsoft Graph API client.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit.is_email_valid"></a>

### is_email_valid

```python
def is_email_valid(self, email: str):
```

Validates a single email address.

**Parameters:**

- **email** (str): Email address to validate.

**Returns:**

  bool: True if the email is valid, False otherwise.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit._get_invalid_emails"></a>

### _get_invalid_emails

```python
def _get_invalid_emails(self, *lists: Optional[List[str]]):
```

Finds invalid email addresses from multiple email lists.

**Returns:**

  List[str]: List of invalid email addresses. Empty list if all
emails are valid.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit._create_attachments"></a>

### _create_attachments

```python
def _create_attachments(self, file_paths: List[str]):
```

Creates Microsoft Graph FileAttachment objects from file paths.

**Parameters:**

- **file_paths** (List[str]): List of local file paths to attach.

**Returns:**

  List[Any]: List of FileAttachment objects ready for Graph API use.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit._create_recipients"></a>

### _create_recipients

```python
def _create_recipients(self, email_list: List[str]):
```

Creates Microsoft Graph Recipient objects from email addresses.

Supports both simple email format ("email@example.com") and
name-email format ("John Doe `<email@example.com>`").

**Parameters:**

- **email_list** (List[str]): List of email addresses, which can include display names.

**Returns:**

  List[Any]: List of Recipient objects ready for Graph API use.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit._create_message"></a>

### _create_message

```python
def _create_message(
    self,
    to_email: Optional[List[str]] = None,
    subject: Optional[str] = None,
    content: Optional[str] = None,
    is_content_html: bool = False,
    attachments: Optional[List[str]] = None,
    cc_recipients: Optional[List[str]] = None,
    bcc_recipients: Optional[List[str]] = None,
    reply_to: Optional[List[str]] = None
):
```

Creates a message object for sending or updating emails.

This helper method is used internally to construct Microsoft Graph
message objects. It's used by methods like send_email,
create_draft_email, and update_draft_message. All parameters are
optional to allow partial updates when modifying existing messages.

**Parameters:**

- **to_email** (Optional[List[str]]): List of recipient email addresses. (default: :obj:`None`)
- **subject** (Optional[str]): The subject of the email. (default: :obj:`None`)
- **content** (Optional[str]): The body content of the email. (default: :obj:`None`)
- **is_content_html** (bool): If True, the content type will be set to HTML; otherwise, it will be Text. (default: :obj:`False`)
- **attachments** (Optional[List[str]]): List of file paths to attach to the email. (default: :obj:`None`)
- **cc_recipients** (Optional[List[str]]): List of CC recipient email addresses. (default: :obj:`None`)
- **bcc_recipients** (Optional[List[str]]): List of BCC recipient email addresses. (default: :obj:`None`)
- **reply_to** (Optional[List[str]]): List of email addresses that will receive replies when recipients use the "Reply" button. This allows replies to be directed to different addresses than the sender's address. (default: :obj:`None`)

**Returns:**

  message.Message: A Microsoft Graph message object with only the
provided fields set.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit.outlook_send_email"></a>

### outlook_send_email

```python
def outlook_send_email(
    self,
    to_email: List[str],
    subject: str,
    content: str,
    is_content_html: bool = False,
    attachments: Optional[List[str]] = None,
    cc_recipients: Optional[List[str]] = None,
    bcc_recipients: Optional[List[str]] = None,
    reply_to: Optional[List[str]] = None,
    save_to_sent_items: bool = True
):
```

Sends an email via Microsoft Outlook.

**Parameters:**

- **to_email** (List[str]): List of recipient email addresses.
- **subject** (str): The subject of the email.
- **content** (str): The body content of the email.
- **is_content_html** (bool): If True, the content type will be set to HTML; otherwise, it will be Text. (default: :obj:`False`)
- **attachments** (Optional[List[str]]): List of file paths to attach to the email. (default: :obj:`None`)
- **cc_recipients** (Optional[List[str]]): List of CC recipient email addresses. (default: :obj:`None`)
- **bcc_recipients** (Optional[List[str]]): List of BCC recipient email addresses. (default: :obj:`None`)
- **reply_to** (Optional[List[str]]): List of email addresses that will receive replies when recipients use the "Reply" button. This allows replies to be directed to different addresses than the sender's address. (default: :obj:`None`)
- **save_to_sent_items** (bool): Whether to save the email to sent items. (default: :obj:`True`)

**Returns:**

  Dict[str, Any]: A dictionary containing the result of the email
sending operation.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit.outlook_create_draft_email"></a>

### outlook_create_draft_email

```python
def outlook_create_draft_email(
    self,
    to_email: List[str],
    subject: str,
    content: str,
    is_content_html: bool = False,
    attachments: Optional[List[str]] = None,
    cc_recipients: Optional[List[str]] = None,
    bcc_recipients: Optional[List[str]] = None,
    reply_to: Optional[List[str]] = None
):
```

Creates a draft email in Microsoft Outlook.

**Parameters:**

- **to_email** (List[str]): List of recipient email addresses.
- **subject** (str): The subject of the email.
- **content** (str): The body content of the email.
- **is_content_html** (bool): If True, the content type will be set to HTML; otherwise, it will be Text. (default: :obj:`False`)
- **attachments** (Optional[List[str]]): List of file paths to attach to the email. (default: :obj:`None`)
- **cc_recipients** (Optional[List[str]]): List of CC recipient email addresses. (default: :obj:`None`)
- **bcc_recipients** (Optional[List[str]]): List of BCC recipient email addresses. (default: :obj:`None`)
- **reply_to** (Optional[List[str]]): List of email addresses that will receive replies when recipients use the "Reply" button. This allows replies to be directed to different addresses than the sender's address. (default: :obj:`None`)

**Returns:**

  Dict[str, Any]: A dictionary containing the result of the draft
email creation operation, including the draft ID.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit.outlook_send_draft_email"></a>

### outlook_send_draft_email

```python
def outlook_send_draft_email(self, draft_id: str):
```

Sends a draft email via Microsoft Outlook.

**Parameters:**

- **draft_id** (str): The ID of the draft email to send. Can be obtained either by creating a draft via `create_draft_email()` or from the 'message_id' field in messages returned by `list_messages()`.

**Returns:**

  Dict[str, Any]: A dictionary containing the result of the draft
email sending operation.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit.outlook_delete_email"></a>

### outlook_delete_email

```python
def outlook_delete_email(self, message_id: str):
```

Deletes an email from Microsoft Outlook.

**Parameters:**

- **message_id** (str): The ID of the email to delete. Can be obtained from the 'message_id' field in messages returned by `list_messages()`.

**Returns:**

  Dict[str, Any]: A dictionary containing the result of the email
deletion operation.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit.outlook_move_message_to_folder"></a>

### outlook_move_message_to_folder

```python
def outlook_move_message_to_folder(self, message_id: str, destination_folder_id: str):
```

Moves an email to a specified folder in Microsoft Outlook.

**Parameters:**

- **message_id** (str): The ID of the email to move. Can be obtained from the 'message_id' field in messages returned by `list_messages()`.
- **destination_folder_id** (str): The destination folder ID, or a well-known folder name. Supported well-known folder names are ("inbox", "drafts", "sentitems", "deleteditems", "junkemail", "archive", "outbox").

**Returns:**

  Dict[str, Any]: A dictionary containing the result of the email
move operation.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit.outlook_get_attachments"></a>

### outlook_get_attachments

```python
def outlook_get_attachments(
    self,
    message_id: str,
    metadata_only: bool = True,
    include_inline_attachments: bool = False,
    save_path: Optional[str] = None
):
```

Retrieves attachments from a Microsoft Outlook email message.

This method fetches attachments from a specified email message and can
either return metadata only or download the full attachment content.
Inline attachments (like embedded images) can optionally be included
or excluded from the results.
Also, if a save_path is provided, attachments will be saved to disk.

**Parameters:**

- **message_id** (str): The unique identifier of the email message from which to retrieve attachments. Can be obtained from the 'message_id' field in messages returned by `list_messages()`.
- **metadata_only** (bool): If True, returns only attachment metadata (name, size, content type, etc.) without downloading the actual file content. If False, downloads the full attachment content. (default: :obj:`True`)
- **include_inline_attachments** (bool): If True, includes inline attachments (such as embedded images) in the results. If False, filters them out. (default: :obj:`False`)
- **save_path** (Optional[str]): The local directory path where attachments should be saved. If provided, attachments are saved to disk and the file paths are returned. If None, attachment content is returned as base64-encoded strings (only when metadata_only=False). (default: :obj:`None`)

**Returns:**

  Dict[str, Any]: A dictionary containing the attachment retrieval
results

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit._build_attachment_query"></a>

### _build_attachment_query

```python
def _build_attachment_query(self):
```

**Returns:**

  AttachmentsRequestBuilderGetRequestConfiguration: Query config
for the Graph API request.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit._fetch_attachments"></a>

### _fetch_attachments

```python
def _fetch_attachments(self, message_id: str, request_config: Optional[Any] = None):
```

Fetches attachments from the Microsoft Graph API.

**Parameters:**

- **message_id** (str): The email message ID.
- **request_config** (Optional[Any]): The request configuration with query parameters. (default: :obj:`None`)

**Returns:**

  Attachments response from the Graph API.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit._process_attachment"></a>

### _process_attachment

```python
def _process_attachment(
    self,
    attachment,
    metadata_only: bool,
    save_path: Optional[str]
):
```

Processes a single attachment and extracts its information.

**Parameters:**

- **attachment**: The attachment object from Graph API.
- **metadata_only** (bool): Whether to include content bytes.
- **save_path** (Optional[str]): Path to save attachment file.

**Returns:**

  Dict: Dictionary containing attachment information.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit._save_attachment_file"></a>

### _save_attachment_file

```python
def _save_attachment_file(
    self,
    save_path: str,
    attachment_name: str,
    content_bytes: bytes,
    cannot_overwrite: bool = True
):
```

Saves attachment content to a file on disk.

**Parameters:**

- **save_path** (str): Directory path where file should be saved.
- **attachment_name** (str): Name of the attachment file.
- **content_bytes** (bytes): The file content as bytes.
- **cannot_overwrite** (bool): If True, appends counter to filename if file exists. (default: :obj:`True`)

**Returns:**

  str: The full file path where the attachment was saved.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit._handle_html_body"></a>

### _handle_html_body

```python
def _handle_html_body(self, body_content: str):
```

Converts HTML email body to plain text.

**Parameters:**

- **body_content** (str): The HTML content of the email body. This content is already sanitized by Microsoft Graph API.

**Returns:**

  str: Plain text version of the email body with cleaned whitespace
and removed HTML tags.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit._get_recipients"></a>

### _get_recipients

```python
def _get_recipients(self, recipient_list: Optional[List[Any]]):
```

Gets a list of recipients from a recipient list object.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit._extract_message_details"></a>

### _extract_message_details

```python
def _extract_message_details(
    self,
    message: Any,
    return_html_content: bool = False,
    include_attachments: bool = False,
    attachment_metadata_only: bool = True,
    include_inline_attachments: bool = False,
    attachment_save_path: Optional[str] = None
):
```

Extracts detailed information from a message object.

This function processes a message object (either from a list response
or a direct fetch) and extracts all relevant details. It can
optionally fetch attachments but does not make additional API calls
for basic message information.

**Parameters:**

- **message** (Any): The Microsoft Graph message object to extract details from.
- **return_html_content** (bool): If True and body content type is HTML, returns the raw HTML content without converting it to plain text. If False and body_type is 'text', HTML content will be converted to plain text. (default: :obj:`False`)
- **include_attachments** (bool): Whether to include attachment information. If True, will make an API call to fetch attachments. (default: :obj:`False`)
- **attachment_metadata_only** (bool): If True, returns only attachment metadata without downloading content. If False, downloads full attachment content. Only used when include_attachments=True. (default: :obj:`True`)
- **include_inline_attachments** (bool): If True, includes inline attachments in the results. Only used when include_attachments=True. (default: :obj:`False`)
- **attachment_save_path** (Optional[str]): Directory path where attachments should be saved. Only used when include_attachments=True and attachment_metadata_only=False. (default: :obj:`None`)

**Returns:**

  Dict[str, Any]: A dictionary containing the message details
including:
- Basic info (message_id, subject, from, received_date_time,
body etc.)
- Recipients (to_recipients, cc_recipients, bcc_recipients)
- Attachment information (if requested)

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit.outlook_get_message"></a>

### outlook_get_message

```python
def outlook_get_message(
    self,
    message_id: str,
    return_html_content: bool = False,
    include_attachments: bool = False,
    attachment_metadata_only: bool = True,
    include_inline_attachments: bool = False,
    attachment_save_path: Optional[str] = None
):
```

Retrieves a single email message by ID from Microsoft Outlook.

This method fetches a specific email message using its unique
identifier and returns detailed information including subject, sender,
recipients, body content, and optionally attachments.

**Parameters:**

- **message_id** (str): The unique identifier of the email message to retrieve. Can be obtained from the 'message_id' field in messages returned by `list_messages()`.
- **return_html_content** (bool): If True and body content type is HTML, returns the raw HTML content without converting it to plain text. If False and body_type is HTML, content will be converted to plain text. (default: :obj:`False`)
- **include_attachments** (bool): Whether to include attachment information in the response. (default: :obj:`False`)
- **attachment_metadata_only** (bool): If True, returns only attachment metadata without downloading content. If False, downloads full attachment content. Only used when include_attachments=True. (default: :obj:`True`)
- **include_inline_attachments** (bool): If True, includes inline attachments in the results. Only used when include_attachments=True. (default: :obj:`False`)
- **attachment_save_path** (Optional[str]): Directory path where attachments should be saved. Only used when include_attachments=True and attachment_metadata_only=False. (default: :obj:`None`)

**Returns:**

  Dict[str, Any]: A dictionary containing the message details
including message_id, subject, from, to_recipients,
cc_recipients, bcc_recipients, received_date_time,
sent_date_time, body, body_type, has_attachments, importance,
is_read, is_draft, body_preview, and optionally attachments.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit._get_messages_from_folder"></a>

### _get_messages_from_folder

```python
def _get_messages_from_folder(self, folder_id: str, request_config):
```

Fetches messages from a specific folder.

**Parameters:**

- **folder_id** (str): The folder ID or well-known folder name.
- **request_config**: The request configuration with query parameters.

**Returns:**

  Messages response from the Graph API, or None if folder not found.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit.outlook_list_messages"></a>

### outlook_list_messages

```python
def outlook_list_messages(
    self,
    folder_ids: Optional[List[str]] = None,
    filter_query: Optional[str] = None,
    order_by: Optional[List[str]] = None,
    top: int = 10,
    skip: int = 0,
    return_html_content: bool = False,
    include_attachment_metadata: bool = False
):
```

Retrieves messages from Microsoft Outlook using Microsoft Graph API.

**Parameters:**

- **folder_ids** (Optional[List[str]]): Folder IDs or well-known names ("inbox", "drafts", "sentitems", "deleteditems", "junkemail", "archive", "outbox"). None searches the entire mailbox.
- **filter_query** (Optional[str]): OData filter for messages.

**Returns:**

  Dict[str, Any]: Dictionary containing messages and
attachment metadata if requested.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit.outlook_reply_to_email"></a>

### outlook_reply_to_email

```python
def outlook_reply_to_email(
    self,
    message_id: str,
    content: str,
    reply_all: bool = False
):
```

Replies to an email in Microsoft Outlook.

**Parameters:**

- **message_id** (str): The ID of the email to reply to.
- **content** (str): The body content of the reply email.
- **reply_all** (bool): If True, replies to all recipients of the original email. If False, replies only to the sender. (default: :obj:`False`)

**Returns:**

  Dict[str, Any]: A dictionary containing the result of the email
reply operation.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit.outlook_update_draft_message"></a>

### outlook_update_draft_message

```python
def outlook_update_draft_message(
    self,
    message_id: str,
    subject: Optional[str] = None,
    content: Optional[str] = None,
    is_content_html: bool = False,
    to_email: Optional[List[str]] = None,
    cc_recipients: Optional[List[str]] = None,
    bcc_recipients: Optional[List[str]] = None,
    reply_to: Optional[List[str]] = None
):
```

Updates an existing draft email message in Microsoft Outlook.

Important: Any parameter provided will completely replace the original
value. For example, if you want to add a new recipient while keeping
existing ones, you must pass all recipients (both original and new) in
the to_email parameter.

**Parameters:**

- **message_id** (str): The ID of the draft message to update.
- **subject** (Optional[str]): Change the subject of the email. Replaces the original subject completely. (default: :obj:`None`)
- **content** (Optional[str]): Change the body content of the email. Replaces the original content completely. (default: :obj:`None`)
- **is_content_html** (bool): Change the content type. If True, sets content type to HTML; if False, sets to plain text. (default: :obj:`False`)
- **to_email** (Optional[List[str]]): Change the recipient email addresses. Replaces all original recipients completely. (default: :obj:`None`)
- **cc_recipients** (Optional[List[str]]): Change the CC recipient email addresses. Replaces all original CC recipients completely. (default: :obj:`None`)
- **bcc_recipients** (Optional[List[str]]): Change the BCC recipient email addresses. Replaces all original BCC recipients completely. (default: :obj:`None`)
- **reply_to** (Optional[List[str]]): Change the email addresses that will receive replies. Replaces all original reply-to addresses completely. (default: :obj:`None`)

**Returns:**

  Dict[str, Any]: A dictionary containing the result of the update
operation.

<a id="camel.toolkits.microsoft_outlook_mail_toolkit.OutlookMailToolkit.get_tools"></a>

### get_tools

```python
def get_tools(self):
```

**Returns:**

  List[FunctionTool]: A list of FunctionTool objects
representing the functions in the toolkit.
